packages = c('sf', 'tmap', 'ggmap', 'rgdal', 'tidyverse', 'qdapTools')
for (p in packages){
if(!require(p, character.only = T)){
install.packages(p)
}
library(p,character.only = T)
}
houses <- read_csv('data/resale-flat-prices/all_flats.csv')
mpsz <- readOGR(dsn='data/mpsz', layer='MP14_SUBZONE_WEB_PL')
houses_sf <- st_as_sf(houses, coords = c("lon", "lat"))
mpsz_sf <- st_as_sf(mpsz)
houses_4326 <- st_transform(houses_sf, '3414')
mpsz_4326 <- st_transform(mpsz_sf, crs = 4326)
houses_4326 <- st_transform(houses_sf, crs=4326)
st_crs(houses_sf) <- st_crs(mpsz_sf)
houses_4326 <- st_transform(houses_sf, crs=4326)
View(mpsz_4326)
View(houses_4326)
merge_spat_aspat <- st_join(mpsz_4326,houses_4326, join=st_within)
merge_spat_aspat <- st_join(mpsz_4326,houses_4326, join=st_intersects)
hawker_centres <- readOGR(dsn='data/hawkercenters/', layer= 'hawker-centres-kkml')
hawker_centres <- readOGR(dsn='data/hawkercenters/', layer= 'hawker-centres-kml')
setwd("C:/IS415/Project")
hawker_centres <- readOGR(dsn='data/hawkercenters/', layer= 'hawker-centres-kml')
hawker_centres <- readOGR(dsn='data/hawkercenters', layer= 'hawker-centres-kml')
hawker_centres <- readOGR(dsn='data/hawkercenters')
hawker_centres <- readOGR(dsn='data/hawkercenters')
hawker_centres <- readOGR(dsn='data/hawkercenters')
hawker_centres <- readOGR(dsn='data/hc')
hawker_centres <- readOGR(dsn='data/mpsz')
hawker_centres <- readOGR(dsn='data/hc')
hawker_centres <- readOGR(dsn="data/hc/hawker-centres-kml.kml", layer="hawker-centres-kml")
ogrListLayers("data/hc/hawker-centres-kml.kml")
hawker_centres <- readOGR(dsn="data/hc/hawker-centres-kml.kml", layer="hawker-centres-kml")
hawker_centres <- readOGR(dsn="data/hc/hawker-centres-kml", layer="hawker-centres-kml")
.kml
hawker_centres <- readOGR(dsn="data/hc/hawker-centres-kml.kml", layer="hawker-centres-kml")
hawker_centres <- readOGR(dsn="data/hc/hawker-centres-kml.kml", layer="hawker-centres-kml.kml")
hawker_centres <- readOGR(dsn="data/hc/hawker-centres-kml.kml", layer="hawker-centres-kml")
hawker_centres <- readOGR(dsn="data/hc/hawker-centres-kml.kml", layer='hawker-centres-kml.kml')
ogrListLayers("data/hawker-centres/hawker-centres-kml.kml")
hawker_centres <- readOGR(dsn="data/hawker-centres/hawker-centres-kml.kml", layer='HAWKERCENTRE')
str(hawker_centres)
head(hawker_centres@data)
View(hawker_centres)
hc_sf <- st_as_sf(hawker_centres)
View(hc_sf)
req_crs <- CRS("+init=epsg:4326")
houses_4326 <- st_transform(houses_sf, crs=req_crs)
hc_df <- geometry(hc_sf)
hc_df <- hc_sf$geometry
View(hc_df)
hc_df[0]
hc_df[1]
hc_df[2]
hc_df[2]$xmin
st_coordinates(hc_sf)
hc_df <- st_coordinates(hc_sf)
View(hc_df)
hc_df$Z
hc_df <- as.matrix(st_coordinates(hc_sf))
View(hc_df)
hc_df <- as.matrix(st_coordinates(hc_sf))
hc_df[0]
hc_df[0][1]
hc_df[X][1]
hc_df['X'][1]
hc_df <- as.data.frame(st_coordinates(hc_sf))
View(hc_df)
hc_df$X
hc_df <- hc_df[,c(1,2)]
View(hc_df)
packages = c('tmap', 'ggmap', 'rgdal', 'tidyverse', 'qdapTools', 'spatstat', 'readr', 'sf')
for (p in packages){
if(!require(p, character.only = T)){
install.packages(p)
}
library(p,character.only = T)
}
houses <- read_csv('data/resale-flat-prices/all_flats.csv')
mpsz <- readOGR(dsn='data/mpsz', layer='MP14_SUBZONE_WEB_PL')
houses_sf <- st_as_sf(houses, coords = c("lon", "lat"))
req_crs <- CRS("+init=epsg:4326")
#Add group ID to each house
houses_sep <- houses %>% separate(address, c("Street", "Block"), sep="block")
houses_group <- houses_sep %>% group_by(Street) %>% summarise(lon = mean(lon), lat=mean(lat))
houses_group$group_id <- c(1:length(unique(houses_group$Street)))
houses$Street <- houses_sep$Street
houses_group_ids <- houses_group[, c("group_id", "Street")]
houses <- inner_join(houses, houses_group_ids)
houses_group_test <- houses_group[1:5, ]
View(houses_group)
write_csv(houses_group, 'all_flats_grouped.csv')
write_csv(houses_group, 'data/resale-flat-prices/all_flats_grouped.csv')
houses_grouped <- read_csv('data/resale-flat-prices/all_flats-grouped.csv')
houses <- read_csv('data/resale-flat-prices/all_flats.csv')
houses_grouped <- read_csv('data/resale-flat-prices/all_flats-grouped.csv')
houses_grouped <- read_csv('data/resale-flat-prices/all_flats-\_grouped.csv')
houses_grouped <- read_csv('data/resale-flat-prices/all_flats_grouped.csv')
View(hc_df)
View(houses_group)
View(houses_group)
View(hc_df)
dist(rbind(houses_latlon[1:5,], hc_df[1:5,]), method="euclidean")
houses_latlon <- houses_group[, c("lat", "lon")]
dist(rbind(houses_latlon[1:5,], hc_df[1:5,]), method="euclidean")
hawker_latlon <- hc_df %>% rename(X = 'lon', Y = 'lat')
hawker_latlon <- hc_df %>% rename(lon = X, lat = Y)
dist(rbind(houses_latlon[1:5,], hc_df[1:5,]), method="euclidean")
dist(rbind(houses_latlon[1:5,], hawker_latlon[1:5,]), method="euclidean")
crossdist(houses_latlon[1:20,]$lat, houses_latlon[1:20,]$lon, hawker_latlon[1:10,]$lat, hawker_latlon[1:10,]$lon)
as.data.frame(crossdist(houses_latlon[1:20,]$lat, houses_latlon[1:20,]$lon, hawker_latlon[1:10,]$lat, hawker_latlon[1:10,]$lon))
as.data.frame(crossdist(houses_latlon[1:10,]$lat, houses_latlon[1:10,]$lon, hawker_latlon[1:10,]$lat, hawker_latlon[1:10,]$lon))
dist_matrix <- as.data.frame(crossdist(houses_latlon[1:10,]$lat, houses_latlon[1:10,]$lon, hawker_latlon[1:10,]$lat, hawker_latlon[1:10,]$lon))
View(dist_matrix)
dist_matrix <- as.data.frame(crossdist(houses_group[1:10,]$lat, houses_group[1:10,]$lon, hc_df[1:10,]$Y, hc_df[1:10,]$X))
dist_matrix
dist_matrix$group = houses_group[1:10]$group_id
dist_matrix$group = houses_group[1:10]$group_id
dist_matrix$group = houses_group[1:10,]$group_id
View(dist_matrix)
dist_matrix$min = apply(DF,1,max)
dist_matrix$min = apply(dist_matrix,1,max)
dist_matrix$min = apply(dist_matrix,1,min)
dist_matrix <- as.data.frame(crossdist(houses_group[1:10,]$lat, houses_group[1:10,]$lon, hc_df[1:10,]$Y, hc_df[1:10,]$X))
dist_matrix$min = apply(dist_matrix,1,min)
dist_matrix$group = houses_group[1:10,]$group_id
houses_group$min_hawker <- dist_matrix$min
houses$min_hawker <- dist_matrix$min
merge(houses, houses_group, by=group)
merge(houses, houses_group, by=group)
merge(houses, houses_group, by='group' )
merge(houses, houses_group, by='group_id')
View(houses)
View(houses_group)
houses <- read_csv('data/resale-flat-prices/all_flats.csv')
#Add group ID to each house
houses_sep <- houses %>% separate(address, c("Street", "Block"), sep="block")
houses_group <- houses_sep %>% group_by(Street) %>% summarise(lon = mean(lon), lat=mean(lat))
houses_group$group_id <- c(1:length(unique(houses_group$Street)))
houses$Street <- houses_sep$Street
houses_group_ids <- houses_group[, c("group_id", "Street")]
View(houses)
houses <- inner_join(houses, houses_group_ids)
View(houses)
write_csv(houses_group, 'data/resale-flat-prices/all_flats_with_group.csv')
write_csv(houses, 'data/resale-flat-prices/all_flats_with_group.csv')
houses <- read_csv('data/resale-flat-prices/all_flat_with_groups.csv')
houses <- read_csv('data/resale-flat-prices/all_flat_with_group.csv')
houses <- read_csv('data/resale-flat-prices/all_flats_with_group.csv')
inner_join(houses_group, houses, by=group_id)
inner_join(houses_group, houses, by='group_id')
View(houses_group)
dist_matrix <- as.data.frame(crossdist(houses_group[1:10,]$lat, houses_group[1:10,]$lon, hc_df[1:10,]$Y, hc_df[1:10,]$X))
dist_matrix$min = apply(dist_matrix,1,min)
dist_matrix$group = houses_group[1:10,]$group_id
```{r echo=FALSE, eval=TRUE, message=FALSE, warning=FALSE}
houses_group$min_hawker <- dist_matrix$min
inner_join(houses_group, houses, by='group_id')
inner_join(houses_group[4:5], houses, by='group_id')
inner_join(houses, houses_group[4:5], by='group_id')
dist_matrix <- as.data.frame(crossdist(houses_group$lat, houses_group$lon, hc_df$Y, hc_df$X))
dist_matrix$min = apply(dist_matrix,1,min)
dist_matrix$group = houses_group$group_id
#head(dist_matrix)
View(dist_matrix)
houses_group$min_hawker <- dist_matrix$min
inner_join(houses, houses_group[4:5], by='group_id')
houses <- inner_join(houses, houses_group[4:5], by='group_id')
View(houses)
View(houses_group)
write.csv(houses, 'all_flats_with_group.csv')
write.csv(houses_group, 'all_flats_grouped.csv')
write.csv(houses, 'data/resale-flat-prices/all_flats_with_group.csv')
write.csv(houses_group, 'data/resale-flat-prices/all_flats_grouped.csv')
plot(houses)
plot(houses_group)
tm_shape(mpsz) + tm_polygons() +
tm_shape(houses_group) + tm_dots()
tm_shape(mpsz) + tm_polygons() +
tm_shape(houses_group) + tm_dots()
tm_shape(mpsz) + tm_polygons() +
tm_shape(st_as_sf(houses_group)) + tm_dots()
#BUS STOP AND HOUSES
tmap_mode('plot')
tm_shape(mpsz) + tm_polygons() +
tm_shape(houses_sf) + tm_bubbles(col='flat_type') +
tm_shape(busStop) + tm_dots()
houses <- read_csv('data/resale-flat-prices/all_flats.csv')
mpsz <- readOGR(dsn='data/mpsz', layer='MP14_SUBZONE_WEB_PL')
houses_sf <- st_as_sf(houses, coords = c("lon", "lat"))
busStop <- readOGR(dsn='data/BusStop', layer='BusStop')
busStop.data <- busStop@data
busStop.data <- distinct(busStop@data, 'BUS_sTOP_N')
busStop <- readOGR(dsn='data/BusStop', layer='BusStop')
busStop.data <- busStop@data
busStop.data <- distinct(busStop@data, 'BUS_sTOP_N')
tm_shape(mpsz) + tm_polygons() +
tm_shape(busStop) + tm_dots()
#BUS STOP AND HOUSES
tmap_mode('plot')
tm_shape(mpsz) + tm_polygons() +
tm_shape(houses_sf) + tm_bubbles(col='flat_type') +
tm_shape(busStop) + tm_dots()
tmap_mode('plot')
houses_sf <- st_as_sf(houses)
houses_sf <- st_as_sf(houses, coords = c("lon", "lat"))
tm_shape(mpsz) + tm_polygons() +
tm_shape(houses_sf) + tm_bubbles(col='flat_type') +
tm_shape(busStop) + tm_dots()
tm_shape(mpsz) + tm_polygons() +
tm_shape(houses_sf) + tm_bubbles(col='flat_type') +
tm_shape(mpsz) + tm_polygons() +
tm_shape(houses_sf) + tm_bubbles(col='flat_type')
tm_shape(mpsz) + tm_polygons() +
tm_shape(houses_sf) + tm_bubbles(col='min_hawker')
tm_shape(mpsz) + tm_polygons() +
tm_shape(houses_sf) + tm_bubbles()
tm_shape(mpsz) + tm_polygons() +
tm_shape(houses_sf) + tm_dots()
packages = c('sf', 'tmap', 'ggmap', 'rgdal', 'tidyverse', 'qdapTools', 'spatstat', 'readr')
for (p in packages){
if(!require(p, character.only = T)){
install.packages(p)
}
library(p,character.only = T)
}
houses <- read_csv('data/resale-flat-prices/all_flats_with_group.csv')
houses_grouped <- read_csv('data/resale-flat-prices/all_flats_grouped.csv')
mpsz <- readOGR(dsn='data/mpsz', layer='MP14_SUBZONE_WEB_PL')
houses_sf <- st_as_sf(houses, coords = c("lon", "lat"))
View(houses)
req_crs <- CRS("+init=epsg:4326")
View(houses_grouped)
houses_grouped_sf <- st_as_sf(houses_grouped, coords = c("lon", "lat"))
tmap_mode('plot')
tm_shape(mpsz) + tm_polygons() +
tm_shape(houses_grouped_sf) + tm_dots()
View(houses_grouped_sf)
tm_shape(mpsz) + tm_polygons() +
tm_shape(houses_grouped_sf) + tm_dots(col='min_hawker')
tm_shape(mpsz) + tm_polygons() +
tm_shape(houses_grouped_sf) +
tm_dots(size='min_hawker')
tm_shape(mpsz) + tm_polygons('min_hawker') +
tm_shape(houses_grouped_sf) +
tm_dots(size='min_hawker')
tm_shape(mpsz) + tm_polygons() +
tm_shape(houses_grouped_sf) +
tm_dots(size='min_hawker',
style='quantile')
tm_shape(mpsz) + tm_polygons() +
tm_shape(houses_grouped_sf) +
tm_bubbles(size='min_hawker',
style='equal')
tm_shape(mpsz) + tm_polygons() +
tm_shape(houses_grouped_sf) +
tm_bubbles(size='min_hawker',
style='equal')
houses_grouped_sf$min_hawker = houses_grouped_sf$min_hawker*1000
houses_grouped_sf <- st_as_sf(houses_grouped, coords = c("lon", "lat"))
houses_grouped_sf$min_hawker = houses_grouped_sf$min_hawker*1000
tm_shape(mpsz) + tm_polygons() +
tm_shape(houses_grouped_sf) +
tm_bubbles(size='min_hawker',
style='equal')
tm_shape(mpsz) + tm_polygons() +
tm_shape(houses_grouped_sf) +
tm_bubbles(size='min_hawker',
style='equal',
col='red')
str(houses_grouped_sf$min_hawker)
tm_shape(mpsz) + tm_polygons() +
tm_shape(houses_grouped_sf) +
tm_bubbles(size='min_hawker',
style='fixed',
col='red',
breaks=c(0,1,10,100,1000,1000))
tm_shape(mpsz) + tm_polygons() +
tm_shape(houses_grouped_sf) +
tm_bubbles(size='min_hawker',
style='fixed',
col='red',
breaks=c(0,1,10,100,1000,1000))
str(houses_grouped_sf$min_hawker)
tm_shape(mpsz) + tm_polygons() +
tm_shape(houses_grouped_sf) +
tm_bubbles(size='min_hawker',
col='red',
breaks=c(0,1,10,100,1000,1000))
tm_shape(mpsz) + tm_polygons() +
tm_shape(houses_grouped_sf) +
tm_bubbles(size='min_hawker',
col='blue',
breaks=c(0,1,10,100,1000,1000))
min(dist_matrix$min)
dist_matrix <- as.data.frame(crossdist(houses_group$lat, houses_group$lon, hc_df$Y, hc_df$X))
min(houses_grouped_sf$min)
max(houses_grouped_sf$min)
mean(houses_grouped_sf$min)
min(houses_grouped_sf$min_hawker)
mean(houses_grouped_sf$min_hawker)
max(houses_grouped_sf$min_hawker)
houses_grouped_sf <- st_as_sf(houses_grouped, coords = c("lon", "lat"))
houses_grouped_sf$min_hawker = houses_grouped_sf$min_hawker
min(houses_grouped_sf$min_hawker)
max(houses_grouped_sf$min_hawker)
min(houses_grouped_sf$min_hawker)
max(houses_grouped_sf$min_hawker)
tm_shape(mpsz) + tm_polygons() +
tm_shape(houses_grouped_sf) +
tm_bubbles(size='min_hawker',
style='fixed',
col='red',
breaks=c(0,1,10,100,1000,1000))
tm_shape(mpsz) + tm_polygons() +
tm_shape(houses_grouped_sf) +
tm_bubbles(size='min_hawker',
col='blue',
breaks=c(0,1,10,100,1000,1000))
tm_shape(mpsz) + tm_polygons() +
tm_shape(houses_grouped_sf) +
tm_bubbles(size='min_hawker',
style="fixed"
col='blue',
tm_shape(mpsz) + tm_polygons() +
tm_shape(houses_grouped_sf) +
tm_bubbles(size='min_hawker',
style="fixed",
col='blue',
breaks=c(0,1,10,100,1000,1000))
packages = c('sf', 'tmap', 'ggmap', 'rgdal', 'tidyverse', 'qdapTools', 'spatstat', 'readr')
for (p in packages){
if(!require(p, character.only = T)){
install.packages(p)
}
library(p,character.only = T)
}
houses <- read_csv('data/resale-flat-prices/all_flats_with_group.csv')
houses_grouped <- read_csv('data/resale-flat-prices/all_flats_grouped.csv')
mpsz <- readOGR(dsn='data/mpsz', layer='MP14_SUBZONE_WEB_PL')
houses_sf <- st_as_sf(houses, coords = c("lon", "lat"))
req_crs <- CRS("+init=epsg:4326")
ogrListLayers("data/hawker-centres/hawker-centres-kml.kml")
hawker_centres <- readOGR(dsn="data/hawker-centres/hawker-centres-kml.kml", layer='HAWKERCENTRE')
tmap_mode('plot')
tm_shape(mpsz) + tm_polygons() +
tm_shape(houses_grouped_sf) +
tm_bubbles(size='min_hawker',
style='fixed',
col='red',
breaks=c(0,1,10,100,1000,1000))
tm_shape(mpsz) + tm_polygons() +
tm_shape(houses_grouped) +
tm_bubbles(size='min_hawker',
style='fixed',
col='red',
breaks=c(0,1,10,100,1000,1000))
hgouses_grouped_sf <- st_as_sf(houses_grouped,  coords = c("lon", "lat"))
houses_grouped_sf <- st_as_sf(houses_grouped,  coords = c("lon", "lat"))
houses_grouped_sf <- st_as_sf(houses_grouped,  coords = c("lon", "lat"))
tm_shape(mpsz) + tm_polygons() +
tm_shape(houses_grouped) +
tm_bubbles(size='min_hawker',
style='fixed',
col='red',
breaks=c(0,1,10,100,1000,1000))
tm_shape(mpsz) + tm_polygons() +
tm_shape(houses_grouped_sf) +
tm_bubbles(size='min_hawker',
style='fixed',
col='red',
breaks=c(0,1,10,100,1000,1000))
