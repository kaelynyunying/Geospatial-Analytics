setwd("C:/IS415/Project/geospatial_analytics")
packages = c('sf', 'tmap', 'ggmap', 'rgdal', 'tidyverse')
for (p in packages){
if(!require(p, character.only = T)){
install.packages(p)
}
library(p,character.only = T)
}
houses <- read_csv('data/resale-flat-prices/all_flats.csv')
mpsz <- readOGR(dsn='data/mpsz', layer='MP14_SUBZONE_WEB_PL')
houses_sf <- st_as_sf(houses, coords = c("lon", "lat"))
busStop <- readOGR(dsn='data/BusStop', layer='BusStop')
busStop.data <- busStop@data
busStop.data <- distinct(busStop@data, 'BUS_sTOP_N')
tm_shape(mpsz) + tm_polygons() +
tm_shape(busStop) + tm_dots()
#BUS STOP AND HOUSES
tmap_mode('plot')
tm_shape(mpsz) + tm_polygons() +
tm_shape(houses_sf) + tm_bubbles(col='flat_type') +
tm_shape(busStop) + tm_dots()
packages = c('sf', 'tmap', 'ggmap', 'rgdal', 'tidyverse')
for (p in packages){
if(!require(p, character.only = T)){
install.packages(p)
}
library(p,character.only = T)
}
houses <- read_csv('data/resale-flat-prices/all_flats.csv')
mpsz <- readOGR(dsn='data/mpsz', layer='MP14_SUBZONE_WEB_PL')
houses_sf <- st_as_sf(houses, coords = c("lon", "lat"))
busStop <- readOGR(dsn='data/BusStop', layer='BusStop')
busStop.data <- busStop@data
busStop.data <- distinct(busStop@data, 'BUS_sTOP_N')
tm_shape(mpsz) + tm_polygons() +
tm_shape(busStop) + tm_dots()
#BUS STOP AND HOUSES
tmap_mode('plot')
tm_shape(mpsz) + tm_polygons() +
tm_shape(houses_sf) + tm_bubbles(col='flat_type') +
tm_shape(busStop) + tm_dots()
taxiStop <- readOGR(dsn='data/taxistand', layer='TaxiStop')
tm_shape(mpsz) + tm_polygons() +
tm_shape(taxiStop) + tm_dots()
#For all KML files
ogrListLayers("data/clinics/chas-clinics-kml.kml")
#For all KML files
ogrListLayers("data/clinics/chas-clinics-kml.kml")
#For all KML files
ogrListLayers("data/clinics/MOH_CHAS_CLINICS.kml")
clinics <- readOGR(dsn="data/clinics/MOH_CHAS_CLINICS.kml", layer="MOH_CHAS_CLINICS")
#For all KML files
ogrListLayers("data/clinics/MOH_CHAS_CLINICS.kml")
clinics <- readOGR(dsn="data/clinics/MOH_CHAS_CLINICS.kml", layer="MOH_CHAS_CLINICS")
tm_shape(mpsz) + tm_polygons() +
tm_shape(clinics) + tm_dots()
ogrListLayers("data/hawkercenters/hawker-centres-kml.kml")
ogrListLayers("data/hawker-centers/hawker-centres-kml.kml")
ogrListLayers("data/hawker-centres/hawker-centres-kml.kml")
hawker_centres <- readOGR(dsn="data/hawker-centres/hawker-centres-kml.kml", layer="HAWKERCENTRE")
ogrListLayers("data/hawker-centres/hawker-centres-kml.kml")
hawker_centres <- readOGR(dsn="data/hawker-centres/hawker-centres-kml.kml", layer="HAWKERCENTRE")
tm_shape(mpsz) + tm_polygons() +
tm_shape(hawker_centres) + tm_dots()
ogrListLayers("data/mrtstation/lta-mrt-station-exit-kml.kml")
mrt_station <- readOGR(dsn="data/mrtstation/lta-mrt-station-exit-kml.kml", layer="MRT_EXITS")
tm_shape(mpsz) + tm_polygons() +
tm_shape(mrt_station) + tm_dots()
ogrListLayers("data/schools/pre-schools-location-kml.kml")
pre_schools <- readOGR(dsn="data/schools/pre-schools-location-kml.kml", layer="PRESCHOOLS_LOCATION")
tm_shape(mpsz) + tm_polygons() +
tm_shape(pre_schools) + tm_dots()
ogrListLayers("data/singapore-police-force-establishment/singapore-police-force-establishments-2018-kml.kml")
singapore_police <- readOGR(dsn="data/singapore-police-force-establishment/singapore-police-force-establishments-2018-kml.kml", layer="SPF_ESTABLISHMENTS_2018")
tm_shape(mpsz) + tm_polygons() +
tm_shape(singapore_police) + tm_dots()
houses <- read_csv('data/resale-flat-prices/all_flats_with_subzone.csv')
houses <- read_csv('data/resale-flat-prices/all_flats_with_subzone.csv')
View(houses)
houses_group <- houses_sep %>% group_by(Street) %>% summarise(lon = mean(lon), lat=mean(lat))
houses_group$group_id <- c(1:length(unique(houses_group$Street)))
houses_group <- houses %>% group_by(Street) %>% summarise(lon = mean(lon), lat=mean(lat))
houses_group$group_id <- c(1:length(unique(houses_group$Street)))
houses_group <- houses %>% group_by(Street) %>% summarise(lon = mean(lon), lat=mean(lat))
str(houses)
mpsz <- readOGR(dsn='data/mpsz', layer='MP14_SUBZONE_WEB_PL')
packages = c('tmap', 'ggmap', 'rgdal', 'tidyverse', 'qdapTools', 'spatstat', 'readr', 'sf')
for (p in packages){
if(!require(p, character.only = T)){
install.packages(p)
}
library(p,character.only = T)
}
mpsz <- readOGR(dsn='data/mpsz', layer='MP14_SUBZONE_WEB_PL')
mpsz <- readOGR(dsn='data/mpsz', layer='MP14_SUBZONE_WEB_PL')
mpsz_sf <- st_as_sf(mpsz)
mpsz_sf <- st_as_sf(mpsz)
mpsz_sf <- st_transform(mpsz_sf, 4326)
mpsz_sf <- st_as_sf(mpsz)
mpsz_sf <- st_transform(mpsz_sf, 4326)
mpsz_sf <- mpsz_sf %>% select(SUBZONE_NO, SUBZONE_N, REGION_N, geometry)
mpsz_sf <- mpsz_sf %>% select(SUBZONE_NO, SUBZONE_N, REGION_N, geometry)
houses <- read_csv('data/resale-flat-prices/all_flats.csv')
houses_sf <- st_as_sf(houses, coords = c("lon", "lat"))
st_crs(houses_sf) <- st_crs(mpsz_sf)
joined_df <- st_join(mpsz_sf, houses_sf, join=st_intersects)
houses <- na.omit(joined_df)
View(houses)
View(houses_sf)
houses <- read_csv('data/resale-flat-prices/all_flats.csv')
houses_sf <- st_as_sf(houses, coords = c("lon", "lat"))
st_crs(houses_sf) <- st_crs(mpsz_sf)
joined_df <- st_join(mpsz_sf, houses_sf, join=st_intersects)
View(houses)
View(joined_df)
joined_df <- na.omit(joined_df)
View(joined_df)
joined_df <- joined_df[,c(1:4)]
View(joined_df)
left_join <- left_join(houses_sf, joined_df)
left_join <- left_join(houses, joined_df)
View(left_join)
st_geometry(joined_df) <- null
st_geometry(joined_df) <- NULL
left_join <- left_join(houses, joined_df)
View(left_join)
houses <- left_join(houses, joined_df)
write_csv(houses, 'data/resale-flat-prices/all_flats_with_subzone.csv')
houses_group <- houses %>% group_by(Street) %>% summarise(lon = mean(lon), lat=mean(lat))
View(houses_group)
houses_group$group_id <- c(1:length(unique(houses_group$Street)))
houses$Street <- houses_sep$Street
houses_group_ids <- houses_group[, c("group_id", "Street")]
houses <- inner_join(houses, houses_group_ids)
View(houses)
write_csv(houses, 'data/resale-flat-prices/all_flats_updated.csv')
View(houses_group)
write_csv(houses_group, 'data/resale-flat-prices/all_flats_grouped.csv')
packages = c('sf', 'tmap', 'ggmap', 'rgdal', 'tidyverse', 'qdapTools', 'spatstat', 'readr')
for (p in packages){
if(!require(p, character.only = T)){
install.packages(p)
}
library(p,character.only = T)
}
houses_grouped <- read_csv('data/resale-flat-prices/all_flats_grouped.csv')
houses_grouped_sf <- st_as_sf(houses_grouped, coords = c("lon", "lat"))
houses_grouped_sf <- st_set_crs(houses_grouped_sf, 4326)
houses_grouped_sf <- st_transform(houses_grouped_sf, 3414)
houses_grouped_df <- as.data.frame(st_coordinates(houses_grouped_sf))
ogrListLayers("data/hawker-centres/hawker-centres-kml.kml")
hawker_centres <- readOGR(dsn="data/hawker-centres/hawker-centres-kml.kml", layer='HAWKERCENTRE')
hc_sf <- st_as_sf(hawker_centres)
hc_sf <- st_set_crs(hc_sf, 4326)
hc_sf <- st_transform(hc_sf, 3414)
#Create lon,lat from hawker centres
hc_df <- as.data.frame(st_coordinates(hc_sf))
hc_df <- hc_df[,c(1,2)]
st_crs(houses_grouped_sf)
st_crs(hc_sf)
#Calculate distance matrix
dist_matrix <- as.data.frame(crossdist(houses_grouped_df$X, houses_grouped_df$Y, hc_df$X, hc_df$Y))
head(dist_matrix)
#get min of all columns
dist_matrix$min_dist <- apply(dist_matrix,1,min)
dist_matrix$group <- houses_grouped$group_id
#ADd to houses df
houses_grouped$min_hawker <- dist_matrix$min_dist
houses <- inner_join(houses, houses_grouped[4:5], by='group_id')
houses <- read_csv('data/resale-flat-prices/all_flats_updated')
houses <- read_csv('data/resale-flat-prices/all_flats_updated.csv')
houses <- inner_join(houses, houses_grouped[4:5], by='group_id')
View(houses)
#Add to CSV
write.csv(houses, 'data/resale-flat-prices/all_flats_updated.csv')
View(houses_grouped)
#Add to CSV
#write.csv(houses, 'data/resale-flat-prices/all_flats_updated.csv')
write.csv(houses_grouped, 'data/resale-flat-prices/all_flats_grouped.csv')
packages = c('sf', 'tmap', 'ggmap', 'rgdal', 'tidyverse', 'qdapTools', 'spatstat', 'readr')
for (p in packages){
if(!require(p, character.only = T)){
install.packages(p)
}
library(p,character.only = T)
}
houses_group_hawker <- read_csv('data/resale-flat-prices/all_flats_grouped.csv')
houses_grouped_sf <- st_as_sf(houses_group_hawker, coords = c("lon", "lat"))
houses_grouped_sf <- st_set_crs(houses_grouped_sf, 4326)
houses_grouped_sf <- st_transform(houses_grouped_sf, 3414)
mpsz <- readOGR(dsn='data/mpsz', layer='MP14_SUBZONE_WEB_PL')
houses_group_hawker <- read_csv('data/resale-flat-prices/all_flats_grouped.csv')
houses_grouped_sf <- st_as_sf(houses_group_hawker, coords = c("lon", "lat"))
houses_grouped_sf <- st_set_crs(houses_grouped_sf, 4326)
houses_grouped_sf <- st_transform(houses_grouped_sf, 3414)
mpsz <- readOGR(dsn='data/mpsz', layer='MP14_SUBZONE_WEB_PL')
ogrListLayers("data/hawker-centres/hawker-centres-kml.kml")
hawker_centres <- readOGR(dsn="data/hawker-centres/hawker-centres-kml.kml", layer='HAWKERCENTRE')
hc_sf <- st_as_sf(hawker_centres)
hc_sf <- st_set_crs(hc_sf, 4326)
hc_sf <- st_transform(hc_sf, 3414)
tmap_mode('plot')
tm_shape(mpsz) + tm_polygons() +
tm_shape(houses_grouped_sf) +
tm_dots(col='min_hawker',
style='quantile',
size=0.5)
tmap_mode('plot')
tm_shape(mpsz) + tm_polygons() +
tm_shape(houses_grouped_sf) +
tm_dots(col='min_hawker',
style='quantile',
size=0.5)
View(houses_group_hawker)
View(houses_grouped_sf)
houses_group_hawker <- read_csv('data/resale-flat-prices/all_flats_grouped.csv')
houses_grouped_sf <- st_as_sf(houses_group_hawker, coords = c("lon", "lat"))
View(houses_grouped_sf)
View(houses_grouped_sf)
houses_group <- read_csv('data/resale-flat-prices/all_flats_grouped.csv)
houses_group <- read_csv('data/resale-flat-prices/all_flats_grouped.csv')
houses_group <- read_csv('data/resale-flat-prices/all_flats_grouped.csv')
View(houses_group)
houses<- read_csv('data/resale-flat-prices/all_flats_updated.csv')
houses <- houses %>% select(c(X1, SUBZONE_NO, SUBZONE_N, REGION_N))
View(houses)
houses_group <- inner_join(houses_group, houses)
View(houses_group)
write_csv(houses_group, 'data/resale-flat-prices/all_flats_grouped.csv')
houses_group_hawker <- read_csv('data/resale-flat-prices/all_flats_grouped.csv')
houses_group_hawker <- read_csv('data/resale-flat-prices/all_flats_grouped.csv')
View(houses_group_hawker)
houses_grouped_sf <- st_as_sf(houses_group_hawker, coords = c("lon", "lat"))
mpsz <- readOGR(dsn='data/mpsz', layer='MP14_SUBZONE_WEB_PL')
tmap_mode('plot')
tm_shape(mpsz) + tm_polygons() +
tm_shape(houses_grouped_sf) +
tm_dots(col='min_hawker',
style='quantile',
size=0.5)
houses_agg <- houses_grouped_sf %>% group_by(SUBZONE_N) %>% summarise(mean=mean(min_hawker))
View(houses_agg)
tm_shape(houses_agg)+ tm_polygons()
mpsz_sf <- st_as_sf(mpsz)
hist(houses_agg)
hist(houses_agg$mean)
barplot(height = houses_agg$mean, houses_agg$SUBZONE_N)
barplot(height = houses_agg$mean)
ggplot(houses_agg)
ggplot(houses_agg, aes(x = mean)) +
geom_histogram(color = "white")
ggplot(houses_agg, aes(x = SUBZONE_N)) +
geom_histogram(color = "white")
ggplot(houses_agg, aes(x = SUBZONE_N)) +
geom_bar(mean)
ggplot(houses_agg, aes(x = SUBZONE_N)) +
geom_bar(aes(mean))
ggplot(houses_agg, aes(x = SUBZONE_N)) +
geom_bar()
ggplot(houses_agg, aes(x = SUBZONE_N, y = mean)) +
geom_bar()
houses_agg <- houses_grouped_sf %>% group_by(SUBZONE_N) %>% summarise(mean_dist=mean(min_hawker))
ggplot(houses_agg, aes(x = SUBZONE_N, y = mean_dist)) +
geom_bar()
ggplot(houses_agg, aes(x = SUBZONE_N)) +
geom_col(mean_dist)
ggplot(houses_agg, aes(x = SUBZONE_N)) +
geom_col(houses_agg$mean_dist)
ggplot(houses_agg, aes(x = SUBZONE_N, mean_dist)) +
geom_col()
View(mpsz)
View(mpsz_sf)
ggplot(houses_agg, aes(x = SUBZONE_N, mean_dist)) +
geom_col() +
theme(axis.text.x = element_text(angle = 90, hjust = 1))
